<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2026å¹´æ–°åˆ¶ç´…ç¶ ç‡ˆå¿«é€Ÿè¨ˆç®—è¡¨</title>
  <style>
    :root{
      --bni-red:#c8102e;
      --card:#ffffff;
      --muted:#f6f6f7;
      --text:#1f2937;
      --sub:#4b5563;
      --border:#e5e7eb;
      --shadow: 0 10px 25px rgba(0,0,0,.12);
      --radius:16px;
    }
    body{
      margin:0;
      font-family: system-ui, -apple-system, "Noto Sans TC", "PingFang TC", "Microsoft JhengHei", sans-serif;
      color:var(--text);
      background: linear-gradient(135deg, var(--bni-red) 0%, #a80c23 55%, #7a0818 100%);
      min-height:100vh;
    }
    header{
      padding: 22px 16px 10px;
      max-width: 1100px;
      margin: 0 auto;
    }
    .title{
      display:flex;
      gap:14px;
      align-items:center;
      flex-wrap:wrap;
      color:white;
    }
    .badge{
      background: rgba(255,255,255,.14);
      border: 1px solid rgba(255,255,255,.25);
      padding: 6px 10px;
      border-radius:999px;
      font-size: 13px;
      backdrop-filter: blur(6px);
    }
    h1{
      margin:0;
      font-size: clamp(22px, 3vw, 34px);
      letter-spacing: .5px;
    }
    .subtitle{
      margin: 10px 0 0;
      color: rgba(255,255,255,.9);
      line-height: 1.5;
      font-size: 14.5px;
      max-width: 980px;
    }

    main{
      max-width:1100px;
      margin: 12px auto 34px;
      padding: 0 16px 24px;
      display:grid;
      grid-template-columns: 1.25fr .75fr;
      gap: 16px;
    }
    @media (max-width: 980px){
      main{ grid-template-columns: 1fr; }
    }

    .card{
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      border: 1px solid rgba(255,255,255,.2);
      overflow:hidden;
    }
    .card-head{
      padding: 14px 16px;
      background: linear-gradient(0deg, #fff 0%, #fff 45%, var(--muted) 100%);
      border-bottom: 1px solid var(--border);
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 12px;
    }
    .card-head h2{
      margin:0;
      font-size: 16px;
    }
    .hint{
      margin: 6px 0 0;
      color: var(--sub);
      font-size: 13px;
      line-height: 1.45;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 8px 10px;
      border-radius: 999px;
      background: #fff;
      border: 1px solid var(--border);
      color: var(--sub);
      font-size: 13px;
      white-space:nowrap;
    }

    table{
      width:100%;
      border-collapse: collapse;
      font-size: 14px;
    }
    thead th{
      text-align:left;
      padding: 12px 14px;
      background: #fafafa;
      border-bottom: 1px solid var(--border);
      color:#111827;
      font-size: 13px;
    }
    tbody td{
      padding: 12px 14px;
      border-bottom: 1px solid var(--border);
      vertical-align: top;
    }
    tbody tr:last-child td{ border-bottom: none; }
    .col-item{ width: 22%; min-width: 160px; }
    .col-rule{ width: 48%; }
    .col-input{ width: 15%; min-width: 140px; }
    .col-score{ width: 15%; min-width: 120px; }

    .item{
      display:flex;
      align-items:flex-start;
      gap: 10px;
      font-weight: 700;
    }
    .icon{
      width: 32px;
      height: 32px;
      flex: 0 0 32px;
      display:grid;
      place-items:center;
      border-radius: 10px;
      background: #fff0f2;
      border: 1px solid #ffd1d8;
    }
    .icon span{ font-size: 18px; }
    .rule{
      color: var(--sub);
      line-height: 1.55;
    }
    .rule ul{
      margin: 6px 0 0 18px;
      padding: 0;
    }
    .rule li{ margin: 4px 0; }

    input[type="number"]{
      width: 100%;
      box-sizing:border-box;
      padding: 10px 10px;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: #fff;
      font-size: 14px;
      outline:none;
      transition: box-shadow .15s, border-color .15s;
    }
    input[type="number"]:focus{
      border-color: #fda4af;
      box-shadow: 0 0 0 4px rgba(253,164,175,.35);
    }
    .mini{
      display:block;
      margin-top: 6px;
      color: #6b7280;
      font-size: 12px;
      line-height: 1.35;
    }
    .scorebox{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 8px;
      background: #fff;
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 10px 10px;
      font-weight: 700;
    }
    .scorebox small{
      font-weight: 600;
      color: #6b7280;
    }

    /* Right panel */
    .side{
      padding: 16px;
    }
    .big{
      font-size: 42px;
      margin: 8px 0 0;
      letter-spacing: .5px;
    }
    .muted{
      color: var(--sub);
      line-height: 1.55;
      font-size: 14px;
      margin: 8px 0 0;
    }
    .light-wrap{
      margin-top: 14px;
      display:flex;
      gap: 14px;
      align-items:center;
      padding: 14px;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      background: #fafafa;
    }
    .light{
      width: 56px;
      height: 56px;
      border-radius: 999px;
      background: #9ca3af; /* default gray */
      box-shadow: inset 0 -10px 16px rgba(0,0,0,.16);
      border: 3px solid rgba(255,255,255,.75);
    }
    .light-label{
      display:flex;
      flex-direction:column;
      gap: 2px;
    }
    .light-label b{ font-size: 16px; }
    .light-label span{ color: var(--sub); font-size: 13px; }

    .legend{
      margin-top: 12px;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      overflow:hidden;
      background:#fff;
    }
    .legend h3{
      margin:0;
      padding: 12px 14px;
      background: #fafafa;
      border-bottom: 1px solid var(--border);
      font-size: 14px;
    }
    .legend .rows{
      padding: 10px 14px 14px;
      display:grid;
      gap: 10px;
    }
    .lg-row{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      font-size: 13px;
      color: var(--sub);
    }
    .dot{
      width: 14px; height: 14px; border-radius: 999px;
      border: 1px solid rgba(0,0,0,.08);
    }
    .dot.gray{ background:#9ca3af; }
    .dot.red{ background:#ef4444; }
    .dot.yellow{ background:#f59e0b; }
    .dot.green{ background:#22c55e; }

    .actions{
      display:flex;
      gap: 10px;
      flex-wrap:wrap;
      margin-top: 14px;
    }
    button{
      appearance:none;
      border:none;
      cursor:pointer;
      border-radius: 999px;
      padding: 10px 14px;
      font-weight: 700;
      font-size: 14px;
    }
    .btn-primary{
      background: var(--bni-red);
      color: white;
      box-shadow: 0 8px 18px rgba(200,16,46,.25);
    }
    .btn-ghost{
      background: #fff;
      border: 1px solid var(--border);
      color: var(--text);
    }
    footer{
      max-width:1100px;
      margin: 0 auto;
      padding: 0 16px 28px;
      color: rgba(255,255,255,.92);
      font-size: 12.5px;
      line-height: 1.6;
    }
    .kbd{
      background: rgba(255,255,255,.16);
      border: 1px solid rgba(255,255,255,.28);
      padding: 2px 8px;
      border-radius: 999px;
      font-weight: 700;
    }
  </style>
</head>

<body>
  <header>
    <div class="title">
      <span class="badge">BNIï½œ2026 æ–°åˆ¶</span>
      <h1>2026å¹´æ–°åˆ¶ç´…ç¶ ç‡ˆå¿«é€Ÿè¨ˆç®—è¡¨</h1>
    </div>
    <p class="subtitle">
      ğŸ“Œ <b>æ•¸æ“šä¾†æºæé†’ï¼š</b>è«‹æ‰“é–‹æ‰‹æ©Ÿ <b>Connect APP</b> â†’ é¸æ“‡ç•«é¢ä¸­çš„ <b>ã€Œ6å€‹æœˆã€</b> çµ±è¨ˆæ•¸æ“šï¼Œ
      å°‡å„é …ç›®é¡¯ç¤ºçš„æ•¸å­—è¼¸å…¥åˆ°æ­¤é é¢ï¼Œå³å¯è‡ªå‹•è¨ˆç®—ç´…ç¶ ç‡ˆæˆç¸¾èˆ‡ç‡ˆè™Ÿã€‚
    </p>
  </header>

  <main>
    <!-- Left: table -->
    <section class="card">
      <div class="card-head">
        <div>
          <h2>è¼¸å…¥å€ï¼ˆ26 é€±ï¼åŠå¹´ï¼‰</h2>
          <div class="hint">æŠŠ Connect APPï¼ˆ6å€‹æœˆï¼‰çœ‹åˆ°çš„æ•¸å­—å¡«é€²ä¾†ï¼Œç³»çµ±æœƒè‡ªå‹•ç®—åˆ†ã€‚</div>
        </div>
        <div class="pill" title="ç‡ˆè™Ÿæœƒéš¨åˆ†æ•¸è‡ªå‹•è®Šå‹•">ğŸš¦ è‡ªå‹•æ›ç‡ˆ</div>
      </div>

      <div style="overflow:auto;">
        <table>
          <thead>
            <tr>
              <th class="col-item">é …ç›®</th>
              <th class="col-rule">è¨ˆåˆ†è¦å‰‡ï¼ˆåŠå¹´ 26 é€±ï¼‰</th>
              <th class="col-input">è¼¸å…¥æ•¸å­—</th>
              <th class="col-score">æœ¬é …å¾—åˆ†</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="col-item">
                <div class="item">
                  <div class="icon"><span>ğŸ“…</span></div>
                  <div>1) å‡ºç¼ºå¸­</div>
                </div>
                <span class="mini">æ»¿åˆ†ï¼š10 åˆ†ï¼ˆèª¿é™ï¼‰</span>
              </td>
              <td class="col-rule">
                <div class="rule">
                  è¼¸å…¥ã€Œç¼ºå¸­æ¬¡æ•¸ã€ï¼š
                  <ul>
                    <li>ç¼ºå¸­ â‰¤ 1 æ¬¡ï¼š10 åˆ†</li>
                    <li>ç¼ºå¸­ 2â€“3 æ¬¡ï¼š5 åˆ†</li>
                    <li>ç¼ºå¸­ â‰¥ 4 æ¬¡ï¼š0 åˆ†ï¼ˆé–‹æ”¾å°ˆæ¥­åˆ¥ï¼‰</li>
                  </ul>
                </div>
              </td>
              <td class="col-input">
                <input id="absences" type="number" min="0" step="1" value="0" inputmode="numeric" />
                <span class="mini">ç¼ºå¸­æ¬¡æ•¸</span>
              </td>
              <td class="col-score">
                <div class="scorebox"><small>åˆ†æ•¸</small><span id="score-absences">0</span></div>
              </td>
            </tr>

            <tr>
              <td class="col-item">
                <div class="item">
                  <div class="icon"><span>ğŸ“</span></div>
                  <div>2) åŸ¹è¨“åˆ†æ•¸</div>
                </div>
                <span class="mini">æ»¿åˆ†ï¼š10 åˆ†ï¼ˆèª¿é™ï¼‰</span>
              </td>
              <td class="col-rule">
                <div class="rule">
                  è¼¸å…¥ã€Œç´¯ç©å­¸åˆ†ã€ï¼š
                  <ul>
                    <li>å­¸åˆ† &gt; 12ï¼š10 åˆ†</li>
                    <li>å­¸åˆ† 1â€“12ï¼š5 åˆ†</li>
                    <li>å­¸åˆ† = 0ï¼š0 åˆ†</li>
                  </ul>
                </div>
              </td>
              <td class="col-input">
                <input id="credits" type="number" min="0" step="0.5" value="0" inputmode="decimal" />
                <span class="mini">ç´¯ç©å­¸åˆ†</span>
              </td>
              <td class="col-score">
                <div class="scorebox"><small>åˆ†æ•¸</small><span id="score-credits">0</span></div>
              </td>
            </tr>

            <tr>
              <td class="col-item">
                <div class="item">
                  <div class="icon"><span>ğŸ¤</span></div>
                  <div>3) ä¸€å°ä¸€</div>
                </div>
                <span class="mini">æ»¿åˆ†ï¼š20 åˆ†ï¼ˆèª¿é«˜ï¼‰</span>
              </td>
              <td class="col-rule">
                <div class="rule">
                  è¼¸å…¥ã€Œä¸€å°ä¸€æ¬¡æ•¸ã€ï¼š
                  <ul>
                    <li>â‰¥ 26 æ¬¡ï¼š20 åˆ†</li>
                    <li>20â€“25 æ¬¡ï¼š15 åˆ†</li>
                    <li>13â€“19 æ¬¡ï¼š10 åˆ†</li>
                    <li>7â€“12 æ¬¡ï¼š5 åˆ†</li>
                    <li>0â€“6 æ¬¡ï¼š0 åˆ†</li>
                  </ul>
                </div>
              </td>
              <td class="col-input">
                <input id="one2one" type="number" min="0" step="1" value="0" inputmode="numeric" />
                <span class="mini">ä¸€å°ä¸€æ¬¡æ•¸</span>
              </td>
              <td class="col-score">
                <div class="scorebox"><small>åˆ†æ•¸</small><span id="score-one2one">0</span></div>
              </td>
            </tr>

            <tr>
              <td class="col-item">
                <div class="item">
                  <div class="icon"><span>ğŸ§‘â€ğŸ¤â€ğŸ§‘</span></div>
                  <div>4) ä¾†è³“æ•¸é‡</div>
                </div>
                <span class="mini">æ»¿åˆ†ï¼š25 åˆ†ï¼ˆèª¿é«˜ï¼‰</span>
              </td>
              <td class="col-rule">
                <div class="rule">
                  è¼¸å…¥ã€Œç´¯ç©ä¾†è³“æ•¸ã€ï¼š
                  <ul>
                    <li>â‰¥ 5 ä½ï¼š25 åˆ†</li>
                    <li>4 ä½ï¼š20 åˆ†</li>
                    <li>3 ä½ï¼š15 åˆ†</li>
                    <li>2 ä½ï¼š10 åˆ†</li>
                    <li>1 ä½ï¼š5 åˆ†</li>
                    <li>0 ä½ï¼š0 åˆ†</li>
                  </ul>
                </div>
              </td>
              <td class="col-input">
                <input id="guests" type="number" min="0" step="1" value="0" inputmode="numeric" />
                <span class="mini">ä¾†è³“äººæ•¸</span>
              </td>
              <td class="col-score">
                <div class="scorebox"><small>åˆ†æ•¸</small><span id="score-guests">0</span></div>
              </td>
            </tr>

            <tr>
              <td class="col-item">
                <div class="item">
                  <div class="icon"><span>âœ¨</span></div>
                  <div>5) ä¾†è³“å…¥æœƒ</div>
                </div>
                <span class="mini">åŠ åˆ†ï¼š+5 åˆ†</span>
              </td>
              <td class="col-rule">
                <div class="rule">
                  è¼¸å…¥ã€ŒåŠå¹´å…§æ˜¯å¦æˆåŠŸè®“ä¾†è³“å…¥æœƒã€ï¼š
                  <ul>
                    <li>æ˜¯ï¼ˆâ‰¥ 1 ä½ï¼‰ï¼š+5 åˆ†</li>
                    <li>å¦ï¼ˆ0 ä½ï¼‰ï¼š0 åˆ†</li>
                  </ul>
                </div>
              </td>
              <td class="col-input">
                <input id="guestToMember" type="number" min="0" step="1" value="0" inputmode="numeric" />
                <span class="mini">æˆåŠŸå…¥æœƒäººæ•¸</span>
              </td>
              <td class="col-score">
                <div class="scorebox"><small>åˆ†æ•¸</small><span id="score-guestToMember">0</span></div>
              </td>
            </tr>

            <tr>
              <td class="col-item">
                <div class="item">
                  <div class="icon"><span>ğŸ§¾</span></div>
                  <div>6) çµ¦å¼•è–¦</div>
                </div>
                <span class="mini">æ»¿åˆ†ï¼š25 åˆ†ï¼ˆèª¿é«˜ï¼‰</span>
              </td>
              <td class="col-rule">
                <div class="rule">
                  è¼¸å…¥ã€Œå¼•è–¦å¼µæ•¸ã€ï¼š
                  <ul>
                    <li>â‰¥ 33 å¼µï¼š25 åˆ†</li>
                    <li>26â€“32 å¼µï¼š20 åˆ†</li>
                    <li>20â€“25 å¼µï¼š15 åˆ†</li>
                    <li>13â€“19 å¼µï¼š10 åˆ†</li>
                    <li>7â€“12 å¼µï¼š5 åˆ†</li>
                    <li>0â€“6 å¼µï¼š0 åˆ†</li>
                  </ul>
                </div>
              </td>
              <td class="col-input">
                <input id="referrals" type="number" min="0" step="1" value="0" inputmode="numeric" />
                <span class="mini">å¼•è–¦å¼µæ•¸</span>
              </td>
              <td class="col-score">
                <div class="scorebox"><small>åˆ†æ•¸</small><span id="score-referrals">0</span></div>
              </td>
            </tr>

            <tr>
              <td class="col-item">
                <div class="item">
                  <div class="icon"><span>ğŸ’°</span></div>
                  <div>7) å¼•è–¦é‡‘é¡</div>
                </div>
                <span class="mini">æ»¿åˆ†ï¼š5 åˆ†ï¼ˆèª¿é™ï¼‰</span>
              </td>
              <td class="col-rule">
                <div class="rule">
                  è¼¸å…¥ã€ŒåŠå¹´å…§æ„Ÿè¬å–®ç¸½é‡‘é¡ï¼ˆå…ƒï¼‰ã€ï¼š
                  <ul>
                    <li>â‰¥ 780,000ï¼š5 åˆ†</li>
                    <li>&gt; 390,000 ä¸” &lt; 780,000ï¼š4 åˆ†</li>
                    <li>&gt; 130,000 ä¸” &lt; 390,000ï¼š3 åˆ†</li>
                    <li>&gt; 52,000 ä¸” &lt; 130,000ï¼š2 åˆ†</li>
                    <li>&gt; 0 ä¸” &lt; 52,000ï¼š1 åˆ†</li>
                    <li>0ï¼š0 åˆ†</li>
                  </ul>
                </div>
              </td>
              <td class="col-input">
                <input id="thanksAmount" type="number" min="0" step="1" value="0" inputmode="numeric" />
                <span class="mini">é‡‘é¡ï¼ˆå…ƒï¼‰</span>
              </td>
              <td class="col-score">
                <div class="scorebox"><small>åˆ†æ•¸</small><span id="score-thanksAmount">0</span></div>
              </td>
            </tr>

          </tbody>
        </table>
      </div>
    </section>

    <!-- Right: results -->
    <aside class="card side">
      <div style="display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap;">
        <div>
          <div class="pill">ğŸ§® è‡ªå‹•åŠ ç¸½</div>
          <div class="big"><span id="totalScore">0</span> <span style="font-size:16px; color:var(--sub); font-weight:700;">/ 100</span></div>
          <div class="muted">
            å°‡ä¸Šæ–¹æ•¸æ“šå¡«å…¥å¾Œï¼Œç³»çµ±æœƒä¾è¦å‰‡è‡ªå‹•è¨ˆç®—ç¸½åˆ†èˆ‡ç‡ˆè™Ÿã€‚<br/>
            âœ… å»ºè­°ï¼šæ¯æ¬¡åˆ†æœƒçµæŸå°±æ›´æ–°ä¸€æ¬¡ï¼Œéš¨æ™‚æŒæ¡è‡ªå·±çš„ç¯€å¥ã€‚
          </div>
        </div>
      </div>

      <div class="light-wrap" aria-live="polite">
        <div class="light" id="trafficLight"></div>
        <div class="light-label">
          <b id="lightName">ç°ç‡ˆ</b>
          <span id="lightRange">ç¸½åˆ† 0â€“29</span>
        </div>
      </div>

      <div class="legend">
        <h3>ç‡ˆè™Ÿå°ç…§</h3>
        <div class="rows">
          <div class="lg-row"><div style="display:flex; align-items:center; gap:8px;"><span class="dot gray"></span>ç°ç‡ˆ</div><div>0â€“29</div></div>
          <div class="lg-row"><div style="display:flex; align-items:center; gap:8px;"><span class="dot red"></span>ç´…ç‡ˆ</div><div>30â€“49</div></div>
          <div class="lg-row"><div style="display:flex; align-items:center; gap:8px;"><span class="dot yellow"></span>é»ƒç‡ˆ</div><div>50â€“69</div></div>
          <div class="lg-row"><div style="display:flex; align-items:center; gap:8px;"><span class="dot green"></span>ç¶ ç‡ˆ</div><div>70â€“100</div></div>
        </div>
      </div>

      <div class="actions">
        <button class="btn-primary" id="btnCopy">ğŸ“‹ è¤‡è£½ç›®å‰ç¸½åˆ†èˆ‡ç‡ˆè™Ÿ</button>
        <button class="btn-ghost" id="btnReset">â†©ï¸ å…¨éƒ¨æ­¸é›¶</button>
      </div>

      <p class="muted" style="margin-top: 12px;">
        ğŸ” <b>å°æé†’</b>ï¼šæœ¬é ä¸æœƒä¸Šå‚³ä½ çš„è³‡æ–™ï¼Œæ‰€æœ‰è¨ˆç®—éƒ½åœ¨ä½ çš„è£ç½®æœ¬åœ°å®Œæˆã€‚
      </p>
    </aside>
  </main>

  <footer>
    ä½¿ç”¨æ–¹å¼ï¼šæ‰“é–‹ <span class="kbd">Connect APP</span> â†’ é¸æ“‡ <span class="kbd">6å€‹æœˆ</span> çµ±è¨ˆ â†’ å°‡æ•¸å­—è¼¸å…¥æœ¬é å³å¯ã€‚<br/>
    è‹¥åˆ†æœƒè¦å‰‡æ›´æ–°ï¼Œä½ å¯ä»¥ç›´æ¥ä¿®æ”¹æœ¬æª”æ¡ˆï¼ˆHTMLï¼‰ä¸­çš„è¦å‰‡å€å¡Šèˆ‡è¨ˆç®—é‚è¼¯ã€‚
  </footer>

  <script>
    const $ = (id) => document.getElementById(id);

    function clamp(n, min, max){
      n = Number.isFinite(n) ? n : 0;
      return Math.max(min, Math.min(max, n));
    }

    function calcAbsences(absences){
      if (absences <= 1) return 10;
      if (absences <= 3) return 5;
      return 0;
    }

    function calcCredits(credits){
      if (credits > 12) return 10;
      if (credits >= 1) return 5;
      return 0;
    }

    function calcOne2One(n){
      if (n >= 26) return 20;
      if (n >= 20) return 15;
      if (n >= 13) return 10;
      if (n >= 7) return 5;
      return 0;
    }

    function calcGuests(n){
      if (n >= 5) return 25;
      if (n === 4) return 20;
      if (n === 3) return 15;
      if (n === 2) return 10;
      if (n === 1) return 5;
      return 0;
    }

    function calcGuestToMember(n){
      return (n >= 1) ? 5 : 0;
    }

    function calcReferrals(n){
      if (n >= 33) return 25;
      if (n >= 26) return 20;
      if (n >= 20) return 15;
      if (n >= 13) return 10;
      if (n >= 7) return 5;
      return 0;
    }

    function calcThanksAmount(amount){
      if (amount >= 780000) return 5;
      if (amount > 390000) return 4;
      if (amount > 130000) return 3;
      if (amount > 52000) return 2;
      if (amount > 0) return 1;
      return 0;
    }

    function getLight(total){
      // 0â€“29 gray, 30â€“49 red, 50â€“69 yellow, 70â€“100 green
      if (total >= 70) return {name:"ç¶ ç‡ˆ", range:"ç¸½åˆ† 70â€“100", color:"#22c55e"};
      if (total >= 50) return {name:"é»ƒç‡ˆ", range:"ç¸½åˆ† 50â€“69", color:"#f59e0b"};
      if (total >= 30) return {name:"ç´…ç‡ˆ", range:"ç¸½åˆ† 30â€“49", color:"#ef4444"};
      return {name:"ç°ç‡ˆ", range:"ç¸½åˆ† 0â€“29", color:"#9ca3af"};
    }

    function readInputs(){
      return {
        absences: clamp(parseInt($("absences").value || "0", 10), 0, 9999),
        credits: clamp(parseFloat($("credits").value || "0"), 0, 9999),
        one2one: clamp(parseInt($("one2one").value || "0", 10), 0, 9999),
        guests: clamp(parseInt($("guests").value || "0", 10), 0, 9999),
        guestToMember: clamp(parseInt($("guestToMember").value || "0", 10), 0, 9999),
        referrals: clamp(parseInt($("referrals").value || "0", 10), 0, 9999),
        thanksAmount: clamp(parseInt($("thanksAmount").value || "0", 10), 0, 999999999),
      };
    }

    function update(){
      const v = readInputs();

      const s1 = calcAbsences(v.absences);
      const s2 = calcCredits(v.credits);
      const s3 = calcOne2One(v.one2one);
      const s4 = calcGuests(v.guests);
      const s5 = calcGuestToMember(v.guestToMember);
      const s6 = calcReferrals(v.referrals);
      const s7 = calcThanksAmount(v.thanksAmount);

      $("score-absences").textContent = s1;
      $("score-credits").textContent = s2;
      $("score-one2one").textContent = s3;
      $("score-guests").textContent = s4;
      $("score-guestToMember").textContent = s5;
      $("score-referrals").textContent = s6;
      $("score-thanksAmount").textContent = s7;

      let total = s1 + s2 + s3 + s4 + s5 + s6 + s7;
      total = clamp(total, 0, 100); // safety
      $("totalScore").textContent = total;

      const light = getLight(total);
      $("trafficLight").style.background = light.color;
      $("lightName").textContent = light.name;
      $("lightRange").textContent = light.range;
    }

    // Bind events
    ["absences","credits","one2one","guests","guestToMember","referrals","thanksAmount"].forEach(id=>{
      $(id).addEventListener("input", update);
      $(id).addEventListener("change", update);
    });

    $("btnReset").addEventListener("click", ()=>{
      ["absences","credits","one2one","guests","guestToMember","referrals","thanksAmount"].forEach(id=>{
        $(id).value = 0;
      });
      update();
    });

    $("btnCopy").addEventListener("click", async ()=>{
      const total = $("totalScore").textContent;
      const name = $("lightName").textContent;
      const text = `BNI 2026 æ–°åˆ¶ç´…ç¶ ç‡ˆæˆç¸¾ï¼š${total} åˆ†ï¼ˆ${name}ï¼‰`;
      try{
        await navigator.clipboard.writeText(text);
        $("btnCopy").textContent = "âœ… å·²è¤‡è£½";
        setTimeout(()=> $("btnCopy").textContent = "ğŸ“‹ è¤‡è£½ç›®å‰ç¸½åˆ†èˆ‡ç‡ˆè™Ÿ", 1400);
      }catch(e){
        alert("ä½ çš„ç€è¦½å™¨ä¸å…è¨±è‡ªå‹•è¤‡è£½ã€‚è«‹æ‰‹å‹•é¸å–ä¸¦è¤‡è£½ï¼š\n" + text);
      }
    });

    // Initial render
    update();
  </script>
</body>
</html>
