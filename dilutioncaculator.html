<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¾²å¥½äº‹ï½è—¥åŠ‘è‚¥æ–™è¼•é¬†ç®—</title>
    
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <style>
        /* åŸºç¤è¨­å®š */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #f0f7f4;
            margin: 0;
            padding: 20px;
            color: #333;
            display: flex;
            justify_content: center;
            align-items: center;
            min-height: 100vh;
        }

        .container {
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 500px;
            padding: 25px;
            box-sizing: border-box;
            position: relative;
        }

        h1 {
            color: #2e7d32;
            text-align: center;
            margin-bottom: 25px;
            font-size: 1.8rem;
        }

        .form-group { margin-bottom: 20px; }

        label {
            display: block;
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 8px;
            color: #1b5e20;
        }

        select {
            width: 100%;
            padding: 15px;
            font-size: 1.2rem;
            border: 2px solid #a5d6a7;
            border-radius: 10px;
            background-color: #fff;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%232e7d32' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 1rem center;
            background-size: 1.5em;
        }

        .result-box {
            background-color: #e8f5e9;
            border: 2px dashed #66bb6a;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            margin-top: 30px;
        }

        .result-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: #c62828;
            display: block;
        }

        button.calc-btn {
            width: 100%;
            background-color: #2e7d32;
            color: white;
            border: none;
            padding: 15px;
            font-size: 1.3rem;
            border-radius: 10px;
            cursor: pointer;
            margin-top: 10px;
        }

        /* å®‰è£æŒ‰éˆ•æ¨£å¼ */
        #installContainer {
            margin-top: 20px;
            text-align: center;
            display: none; /* é è¨­éš±è—ï¼Œåµæ¸¬åˆ°å¯å®‰è£æ‰é¡¯ç¤º */
            padding-top: 20px;
            border-top: 1px solid #eee;
        }

        #installBtn {
            background-color: #ff9800; /* æ©˜è‰²é†’ç›® */
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 1rem;
            border-radius: 20px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }
        
        /* iOS æç¤ºå€å¡Š */
        #iosInstallPrompt {
            display: none;
            background: #f8f9fa;
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            font-size: 0.9rem;
            color: #555;
            text-align: left;
        }

        .footer {
            text-align: center;
            margin-top: 20px;
            font-size: 0.9rem;
            color: #888;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>ğŸŒ± è¾²å¥½äº‹<br><span style="font-size:0.8em; color:#666;">è—¥åŠ‘è‚¥æ–™è¼•é¬†ç®—</span></h1>

        <div class="form-group">
            <label for="dilution">ç¨€é‡‹å€æ•¸</label>
            <select id="dilution" onchange="calculate()">
                <option value="100">100 å€</option>
                <option value="200">200 å€</option>
                <option value="300">300 å€</option>
                <option value="400">400 å€</option>
                <option value="500">500 å€</option>
                <option value="800">800 å€</option>
                <option value="1000" selected>1000 å€ (é è¨­)</option>
                <option value="1500">1500 å€</option>
                <option value="2000">2000 å€</option>
                <option value="3000">3000 å€</option>
                <option value="5000">5000 å€</option>
                <option value="10000">10000 å€</option>
                <option value="20000">20000 å€</option>
                <option value="50000">50000 å€</option>
            </select>
        </div>

        <div class="form-group">
            <label for="water">ç”¨æ°´é‡ (å…¬å‡)</label>
            <select id="water" onchange="calculate()">
                <option value="10">10 å…¬å‡</option>
                <option value="16" selected>16 å…¬å‡ (èƒŒæ¡¶)</option>
                <option value="20">20 å…¬å‡</option>
                <option value="25">25 å…¬å‡ (å‹•åŠ›æ¡¶)</option>
                <option value="120">120 å…¬å‡</option>
                <option value="200">200 å…¬å‡ (å¤§æ¡¶)</option>
                <option value="300">300 å…¬å‡</option>
                <option value="500">500 å…¬å‡</option>
                <option value="1000">1000 å…¬å‡ (ä¸€å™¸)</option>
            </select>
        </div>

        <button class="calc-btn" onclick="calculate()">è¨ˆç®—ä½¿ç”¨é‡</button>

        <div class="result-box">
            <div class="result-title">è«‹åŠ å…¥è—¥åŠ‘ / è‚¥æ–™</div>
            <span id="resultValue" class="result-value">0</span>
            <span class="result-unit">æ¯«å‡(cc) æˆ– å…¬å…‹(g)</span>
        </div>

        <div id="installContainer">
            <button id="installBtn">ğŸ“² ä¸‹è¼‰ App åˆ°æ¡Œé¢</button>
        </div>

        <div id="iosInstallPrompt">
            <strong>ğŸ iPhone ç”¨æˆ¶è«‹é€™æ¨£åšï¼š</strong><br>
            1. é»æ“Šä¸‹æ–¹ç€è¦½å™¨çš„ <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNCIgaGVpZ2h0PSIxNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiMwMDdlZmYiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMyAxMnY4YzAgMS4xLjk5NiAyIDIuMDExIDIuMDAxaDEzLjk3OEMyMC4wMDggMjIgMjEgMjEuMSAyMSAyMHYtOCIvPjxwb2x5bGluZSBwb2ludHM9IjE2IDYgMTIgMiA4IDYiLz48bGluZSB4MT0iMTIiIHkxPSIyIiB4Mj0iMTIiIHkyPSIxNSIvPjwvc3ZnPg==" style="vertical-align:middle"> <strong>åˆ†äº«æŒ‰éˆ•</strong><br>
            2. æ»‘å‹•é¸å–®æ‰¾åˆ°ä¸¦é»é¸ <strong>ã€ŒåŠ å…¥ä¸»ç•«é¢ã€</strong> å³å¯ã€‚
        </div>

        <div class="footer">è¾²ä½œè¨ˆç®—å°å¹«æ‰‹ | é©ç”¨æ–¼æ¶²é«”èˆ‡ç²‰åŠ‘</div>
    </div>

    <script>
        function calculate() {
            const dilution = parseFloat(document.getElementById('dilution').value);
            const water = parseFloat(document.getElementById('water').value);
            let result = (water * 1000) / dilution;
            
            let displayResult;
            if (result < 1) {
                displayResult = result.toFixed(3);
            } else if (Number.isInteger(result)) {
                displayResult = result;
            } else {
                displayResult = result.toFixed(1);
            }
            document.getElementById('resultValue').innerText = displayResult;
        }
        window.onload = calculate;

        // PWA å®‰è£é‚è¼¯
        let deferredPrompt;
        const installContainer = document.getElementById('installContainer');
        const iosPrompt = document.getElementById('iosInstallPrompt');

        // åµæ¸¬æ˜¯å¦ç‚º iOS
        const isIos = () => {
          const userAgent = window.navigator.userAgent.toLowerCase();
          return /iphone|ipad|ipod/.test( userAgent );
        }

        // 1. Android/Chrome è™•ç†
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            // é¡¯ç¤ºå®‰è£æŒ‰éˆ•
            installContainer.style.display = 'block';
        });

        document.getElementById('installBtn').addEventListener('click', async () => {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                if (outcome === 'accepted') {
                    installContainer.style.display = 'none';
                }
                deferredPrompt = null;
            }
        });

        // 2. iOS è™•ç† (å¦‚æœæ˜¯ iOS ä¸”æ²’å®‰è£åœ¨ä¸»ç•«é¢æ¨¡å¼ä¸‹)
        const isInStandaloneMode = () => ('standalone' in window.navigator) && (window.navigator.standalone);
        
        if (isIos() && !isInStandaloneMode()) {
            iosPrompt.style.display = 'block';
        }
    </script>
</body>
</html>
